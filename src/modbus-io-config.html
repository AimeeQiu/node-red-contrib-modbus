<!--
 Copyright (c) 2016,2017, Klaus Landsdorf (http://bianco-royal.de/)
 All rights reserved.
 node-red-contrib-modbus - The BSD 3-Clause License
 node-red-contrib-modbusio - The BSD 3-Clause License

 @author <a href="mailto:klaus.landsdorf@bianco-royal.de">Klaus Landsdorf</a> (Bianco Royal)
-->

<script type="text/javascript">
    RED.nodes.registerType('modbus-io-config', {
        category: 'config',
        color: '#E9967A',
        defaults: {
            name: {value: ''},
            path: {value: '', required: true},
            format: {value: "utf8"}
        },
        label: function () {
            return "IO:" + this.name + "@" + this.path;
        },
        oneditprepare: function () {
        },
        oneditsave: function () {
        }
    });
</script>


<script type="text/x-red" data-template-name="modbus-io-config">
    <div class="form-row" style="min-width:640px">
        <label for="node-config-input-name"><i class="icon-tag"></i> <span data-i18n="node-red:common.label.name"></span></label>
        <input type="text" id="node-config-input-name">
    </div>
    <div class="form-row">
        <label for="node-config-input-path"><i class="icon-file"></i> <span data-i18n="modbus-contrib.label.path"></span></label>
        <input type="text" id="node-config-input-path">
    </div>
    <div class="form-row">
        <label for="node-config-input-format"><i class="fa fa-file-code-o"></i> <span data-i18n="modbus-contrib.label.format"></span></label>
        <select id="node-config-input-format">
            <option value="utf8" data-i18n="modbus-contrib.label.utf8"></option>
            <option value="ansi" data-i18n="modbus-contrib.label.ansi"></option>
            <option value="" data-i18n="modbus-contrib.label.buffer"></option>
        </select>
    </div>
</script>


<script type="text/x-red" data-help-name="modbus-io-config">
    <p>MODBUS I/O JSON for register and coil addresses.</p>

    <div>
        <pre>
        [{"id":"48729ed3.0b9ce","type":"file in","z":"d7a8d841.8f2be8","name":"Modbus I/O File devices.csv",
        "filename":"/Users/Shared/modbus/device.csv","format":"utf8","sendError":true,"x":420,"y":320,"wires":[["61f8097.ae7b7f8"]]},
        {"id":"24c6a2d1.f13146","type":"inject","z":"d7a8d841.8f2be8","name":"","topic":"","payload":"","payloadType":"date",
        "repeat":"","crontab":"","once":false,"x":220,"y":320,"wires":[["48729ed3.0b9ce"]]},
        {"id":"61f8097.ae7b7f8","type":"csv","z":"d7a8d841.8f2be8","name":"","sep":";","hdrin":"","hdrout":"",
        "multi":"one","ret":"\\n","temp":"","x":650,"y":320,"wires":[["b79bce66.7a6208"]]},{"id":"da10d940.a0cd48","type":"debug",
        "z":"d7a8d841.8f2be8","name":"","active":true,"console":"false","complete":"false","x":1030,"y":280,"wires":[]},
        {"id":"b79bce66.7a6208","type":"function","z":"d7a8d841.8f2be8","name":"Filter named Register",
        "func":"if(msg.payload.col4 !== undefined && msg.payload.col4.indexOf('//') === -1) {\n    var varName = msg.payload.col4;\n    var varValue = msg.payload.col5;\n    msg.payload = { 'name': varName, 'valueAddress': varValue };\n    return msg;\n}\n",
        "outputs":1,"noerr":0,"x":820,"y":320,"wires":[["da10d940.a0cd48","3a728e5b.6ba6c2"]]},{"id":"3a728e5b.6ba6c2",
        "type":"file","z":"d7a8d841.8f2be8","name":"","filename":"/Users/Shared/modbus/device.json","appendNewline":true,
        "createDir":false,"overwriteFile":"false","x":1100,"y":320,"wires":[]},{"id":"e2644f58.7d1698","type":"inject",
        "z":"d7a8d841.8f2be8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,
        "x":220,"y":280,"wires":[["37a6655f.06fb12"]]},{"id":"37a6655f.06fb12","type":"file","z":"d7a8d841.8f2be8","name":"",
        "filename":"/Users/Shared/modbus/slaveDevice.json","appendNewline":true,"createDir":false,"overwriteFile":"delete","x":480,"y":280,"wires":[]}]
        </pre>
    </div>
</script>